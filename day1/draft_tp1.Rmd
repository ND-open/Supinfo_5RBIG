---
title: "draft tp1"
output: 
  html_document:
          toc: yes
---

```{r}
# Chargement des lib
suppressPackageStartupMessages( library(dplyr) )
```


```{r}
suppressPackageStartupMessages( library(ggplot2) )
```


## TRIPADVISOR usecase

Analyse des variables (types)

```{r}
# getwd()
# dfr <- utils::read.csv("Tripadvisor.csv")
```


```{r}
# dfr2 <- readr::read_csv("Tripadvisor.csv")
# dfr3 <- data.table::fread("Tripadvisor.csv", header = TRUE)
# str(dfr3)
```


```{r}
dfr <- vroom::vroom("Tripadvisor.csv", delim = ",", col_names = TRUE) # , skip = 1
dfr
```


```{r}
# res <- microbenchmark::microbenchmark(utils::read.csv("Tripadvisor.csv"),
#                                readr::read_csv("Tripadvisor.csv"),
#                                data.table::fread("Tripadvisor.csv", header = TRUE),
#                                vroom::vroom("Tripadvisor.csv", delim = ",", col_names = TRUE), times = 10
# )

# knitr::kable(res)
# saveRDS(res, "load_data_benchmark.rds")
res <- readRDS("load_data_benchmark.rds")
knitr::kable(res)
summary(res)
```


```{r}
# str(dfr)
dfr %>% glimpse()
```


* 1) Study the different categorical variables: frequencies, proportions, charts.

```{r}
dfr %>% 
        select_if(is.character)
```

Conversion des chaine des caractère en facteurs.

```{r}
df_clean <- dfr %>% mutate_if(is.character, factor)
```


Summary & Barplot

```{r}
summary(df_clean)
```

Pour une var

```{r}
df_clean %>% 
        # ggplot(aes(x = City)) + geom_bar() +coord_flip()
        count(City) %>%
        ggplot(aes(x = forcats::fct_reorder(City, .x = n), y = n)) +
        geom_bar(stat = "identity") +
        coord_flip()
```

Croisée quali / quali

```{r}
df_clean %>% 
        group_by(City, PriceRange) %>% 
        summarise(nb = n()) %>% 
        ggplot(aes(PriceRange, City, fill = nb)) +
        geom_tile() +
        scale_fill_gradient2()
```



* 2) Study the different quantitative variables:  descriptives statistics, charts.

* 3) Study associations between categorical variables.

* 4) Study associations between quantitative variables and categorical variables.

* 5) Perform t-tests to compare pairwise the rating or the number of reviews of some cities.

* 6) Perform an ANOVA to compare the rating or the number of reviews depending on the city. 

## WORLD HAPPINESS REPORT
